import{as as e}from"../_/nitro.mjs";import{l as t}from"../_/shared.esm-bundler.mjs";import{v as a,h as o,i as s,j as n}from"./server.mjs";function useFetch(t,r,u){const[i={},c]="string"==typeof r?[{},r]:[r,u],l=a.computed(()=>a.toValue(t)),f=a.computed(()=>a.toValue(i.key)||"$f"+e([c,"string"==typeof l.value?l.value:"",...generateOptionSegments(i)]));if(!i.baseURL&&"string"==typeof l.value&&"/"===l.value[0]&&"/"===l.value[1])throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:h,lazy:m,default:p,transform:d,pick:v,watch:y,immediate:g,getCachedData:b,deep:V,dedupe:w,timeout:F,...U}=i,j=a.reactive({...o,...U,cache:"boolean"==typeof i.cache?void 0:i.cache}),L={server:h,lazy:m,default:p,transform:d,pick:v,immediate:g,getCachedData:b,deep:V,dedupe:w,timeout:F,watch:!1===y?[]:[...y||[],j]};if(!g){let setImmediate=function(){L.immediate=!0};a.watch(f,setImmediate,{flush:"sync",once:!0}),a.watch([...y||[],j],setImmediate,{flush:"sync",once:!0})}return s(!1===y?f.value:f,(e,{signal:t})=>{let o=i.$fetch||globalThis.$fetch;if(!i.$fetch){"string"==typeof l.value&&"/"===l.value[0]&&(!a.toValue(i.baseURL)||"/"===a.toValue(i.baseURL)[0])&&(o=n())}return o(l.value,{signal:t,...j})},L)}function generateOptionSegments(o){var s;const n=[(null==(s=a.toValue(o.method))?void 0:s.toUpperCase())||"GET",a.toValue(o.baseURL)];for(const e of[o.query||o.params]){const t=a.toValue(e);if(!t)continue;const o={};for(const[e,s]of Object.entries(t))o[a.toValue(e)]=a.toValue(s);n.push(o)}if(o.body){const s=a.toValue(o.body);if(s)if(s instanceof ArrayBuffer)n.push(e(Object.fromEntries([...new Uint8Array(s).entries()].map(([e,t])=>[e,t.toString()]))));else if(s instanceof FormData){const t={};for(const e of s.entries()){const[a,o]=e;t[a]=o instanceof File?o.name:o}n.push(e(t))}else if(t(s))n.push(e(a.reactive(s)));else try{n.push(e(s))}catch{console.warn("[useFetch] Failed to hash body",s)}else n.push(e(s))}return n}export{useFetch as u};
//# sourceMappingURL=fetch-CFsjn0J_.mjs.map
