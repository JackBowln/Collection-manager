import{v as e,u as r,a as t,d as i,n as a,_ as o,c as s,e as l}from"./server.mjs";import{_ as n}from"./Card-Dskk1veu.mjs";import{_ as c}from"./Dropdown-TOktksTi.mjs";import{_ as d}from"./Badge-BRw-NuRI.mjs";import{u as p}from"./useSupabaseClient-CBvWxwze.mjs";import{A as u,D as m,y as x,G as g}from"../routes/renderer.mjs";import"../_/nitro.mjs";import"node:async_hooks";import"../_/shared.esm-bundler.mjs";import"./usePopper-BnxSMfCG.mjs";import"./keyboard-DfXvXu8t.mjs";const v=e.defineComponent({__name:"index",__ssrInlineRender:!0,async setup(v){let y,f;const h=p(),b=r(),w=t(),{data:k,pending:_,refresh:C}=([y,f]=e.withAsyncContext(async()=>i("my-collections",async()=>{var e;const{data:r,error:t}=await h.from("collections").select("*").eq("user_id",null==(e=b.value)?void 0:e.id).order("created_at",{ascending:!1});if(t)throw t;return r||[]})),y=await y,f(),y),{data:N,pending:V,refresh:$}=([y,f]=e.withAsyncContext(async()=>i("shared-collections",async()=>{var e;const{data:r,error:t}=await h.from("collection_shares").select("\n      id,\n      collection:collections (\n         id, name, description, created_at, visibility,\n         owner:profiles ( full_name, avatar_url, email )\n      )\n    ").eq("user_id",null==(e=b.value)?void 0:e.id);if(t)throw t;return r||[]})),y=await y,f(),y),getActionItems=e=>[[{label:"Editar",icon:"i-heroicons-pencil-square",click:()=>a(`/collections/${e.id}/edit`)}],[{label:"Excluir",icon:"i-heroicons-trash",click:()=>confirmDelete(e.id)}]],goToCollection=e=>{a(`/collections/${e}`)},confirmDelete=async e=>{if(!confirm("Tem certeza que deseja excluir esta coleção e todos os seus itens?"))return;const{error:r}=await h.from("collections").delete().eq("id",e);r?w.add({title:"Erro",description:r.message,color:"red"}):(w.add({title:"Sucesso",description:"Coleção excluída",color:"green"}),C(),$())};return(r,t,i,a)=>{var p,v,y,f;const h=o,w=s,C=n,$=c,j=d,S=l;t(`<div${u(a)}><div class="flex flex-col md:flex-row justify-between items-end mb-10 gap-4"><div><h1 class="text-3xl font-extrabold tracking-tight text-gray-900 dark:text-white mb-2"> Bem-vindo, <span class="text-primary-500">${m(null==(v=null==(p=e.unref(b))?void 0:p.user_metadata.full_name)?void 0:v.split(" ")[0])}</span></h1><p class="text-gray-500 dark:text-gray-400">Gerencie suas coleções ou descubra novidades.</p></div>`),t(x(h,{to:"/collections/new",icon:"i-heroicons-plus",size:"lg",class:"shadow-lg shadow-primary-500/20 hover:scale-105 transition-transform"},{default:e.withCtx((r,t,i,a)=>{if(!t)return[e.createTextVNode(" Nova Coleção ")];t(" Nova Coleção ")}),_:1},i)),t('</div><div class="space-y-8"><section><h2 class="text-lg font-semibold mb-4 flex items-center gap-2">'),t(x(w,{name:"i-heroicons-user"},null,i)),t(" Minhas Coleções </h2>"),e.unref(_)?(t('<div class="flex justify-center py-8">'),t(x(w,{name:"i-heroicons-arrow-path",class:"w-8 h-8 animate-spin text-gray-400"},null,i)),t("</div>")):0===(null==(y=e.unref(k))?void 0:y.length)?t('<div class="text-center py-8 border-2 border-dashed border-gray-200 dark:border-gray-800 rounded-lg"><p class="text-gray-500">Você não tem coleções criadas.</p></div>'):(t('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">\x3c!--[--\x3e'),g(e.unref(k),r=>{t(x(C,{key:r.id,class:"group cursor-pointer border-0 ring-1 ring-gray-200 dark:ring-gray-800 shadow-sm hover:shadow-xl hover:ring-primary-500/50 dark:hover:ring-primary-500/50 transition-all duration-300 transform hover:-translate-y-1 bg-white dark:bg-gray-900 overflow-hidden",onClick:e=>goToCollection(r.id)},{default:e.withCtx((t,i,a,o)=>{if(!i)return[e.createVNode("div",{class:"absolute top-0 right-0 p-4 opacity-0 group-hover:opacity-100 transition-opacity z-10"},[e.createVNode($,{items:getActionItems(r),onClick:e.withModifiers(()=>{},["stop"])},{default:e.withCtx(()=>[e.createVNode(h,{color:"gray",variant:"soft",icon:"i-heroicons-ellipsis-vertical",size:"xs"})]),_:1},8,["items","onClick"])]),e.createVNode("div",{class:"p-4 flex flex-col h-full"},[e.createVNode("div",{class:"w-12 h-12 rounded-xl bg-primary-50 dark:bg-primary-900/50 flex items-center justify-center text-primary-500 mb-4 group-hover:scale-110 transition-transform duration-300"},[e.createVNode(w,{name:"i-heroicons-folder",class:"w-7 h-7"})]),e.createVNode("h3",{class:"text-xl font-bold text-gray-900 dark:text-white mb-2 line-clamp-1 group-hover:text-primary-500 transition-colors"},e.toDisplayString(r.name),1),e.createVNode("p",{class:"text-gray-500 dark:text-gray-400 text-sm line-clamp-2 mb-4 flex-1"},e.toDisplayString(r.description||"Sem descrição definida."),1),e.createVNode("div",{class:"flex items-center justify-between pt-4 border-t border-gray-100 dark:border-gray-800"},[e.createVNode("span",{class:"text-xs text-gray-400 font-mono"},e.toDisplayString(new Date(r.created_at).toLocaleDateString()),1),e.createVNode(j,{size:"xs",variant:"subtle",color:"public"===r.visibility?"green":"shared"===r.visibility?"purple":"gray"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString("public"===r.visibility?"Público":"shared"===r.visibility?"Compartilahdo":"Privado"),1)]),_:2},1032,["color"])])])];i(`<div class="absolute top-0 right-0 p-4 opacity-0 group-hover:opacity-100 transition-opacity z-10"${o}>`),i(x($,{items:getActionItems(r),onClick:()=>{}},{default:e.withCtx((r,t,i,a)=>{if(!t)return[e.createVNode(h,{color:"gray",variant:"soft",icon:"i-heroicons-ellipsis-vertical",size:"xs"})];t(x(h,{color:"gray",variant:"soft",icon:"i-heroicons-ellipsis-vertical",size:"xs"},null,i,a))}),_:2},a,o)),i(`</div><div class="p-4 flex flex-col h-full"${o}><div class="w-12 h-12 rounded-xl bg-primary-50 dark:bg-primary-900/50 flex items-center justify-center text-primary-500 mb-4 group-hover:scale-110 transition-transform duration-300"${o}>`),i(x(w,{name:"i-heroicons-folder",class:"w-7 h-7"},null,a,o)),i(`</div><h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2 line-clamp-1 group-hover:text-primary-500 transition-colors"${o}>${m(r.name)}</h3><p class="text-gray-500 dark:text-gray-400 text-sm line-clamp-2 mb-4 flex-1"${o}>${m(r.description||"Sem descrição definida.")}</p><div class="flex items-center justify-between pt-4 border-t border-gray-100 dark:border-gray-800"${o}><span class="text-xs text-gray-400 font-mono"${o}>${m(new Date(r.created_at).toLocaleDateString())}</span>`),i(x(j,{size:"xs",variant:"subtle",color:"public"===r.visibility?"green":"shared"===r.visibility?"purple":"gray"},{default:e.withCtx((t,i,a,o)=>{if(!i)return[e.createTextVNode(e.toDisplayString("public"===r.visibility?"Público":"shared"===r.visibility?"Compartilahdo":"Privado"),1)];i(`${m("public"===r.visibility?"Público":"shared"===r.visibility?"Compartilahdo":"Privado")}`)}),_:2},a,o)),i("</div></div>")}),_:2},i))}),t("\x3c!--]--\x3e</div>")),t('</section><section><h2 class="text-lg font-semibold mb-4 flex items-center gap-2 text-purple-600 dark:text-purple-400">'),t(x(w,{name:"i-heroicons-users"},null,i)),t(" Compartilhado Comigo </h2>"),e.unref(V)?t('<div class="text-sm text-gray-400">Carregando compartilhamentos...</div>'):0===(null==(f=e.unref(N))?void 0:f.length)?t('<div class="text-center py-8 bg-gray-50 dark:bg-gray-800 rounded-lg"><p class="text-gray-500 text-sm">Ninguém compartilhou coleções com você ainda.</p></div>'):(t('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">\x3c!--[--\x3e'),g(e.unref(N),r=>{t(x(C,{key:r.collection.id,class:"group cursor-pointer border-0 ring-1 ring-purple-100 dark:ring-purple-900/30 shadow-sm hover:shadow-purple-500/20 hover:ring-purple-500/50 transition-all duration-300 transform hover:-translate-y-1 bg-white dark:bg-gray-900",onClick:e=>goToCollection(r.collection.id)},{default:e.withCtx((t,i,a,o)=>{var s,l,n,c;if(!i)return[e.createVNode("div",{class:"p-4 flex flex-col h-full"},[e.createVNode("div",{class:"flex justify-between items-start mb-3"},[e.createVNode("div",{class:"w-10 h-10 rounded-lg bg-purple-50 dark:bg-purple-900/30 flex items-center justify-center text-purple-600 dark:text-purple-400"},[e.createVNode(w,{name:"i-heroicons-folder-open",class:"w-6 h-6"})]),e.createVNode(w,{name:"i-heroicons-eye",class:"text-gray-300 group-hover:text-purple-500 transition-colors"})]),e.createVNode("h3",{class:"text-lg font-bold text-gray-900 dark:text-white mb-1 group-hover:text-purple-500 transition-colors"},e.toDisplayString(r.collection.name),1),e.createVNode("p",{class:"text-gray-500 text-sm line-clamp-2 mb-4 flex-1"},e.toDisplayString(r.collection.description||"Sem descrição"),1),e.createVNode("div",{class:"flex items-center gap-2 pt-3 border-t border-gray-100 dark:border-gray-800"},[e.createVNode(S,{src:null==(n=r.collection.owner)?void 0:n.avatar_url,size:"xs",class:"ring-2 ring-white dark:ring-gray-900"},null,8,["src"]),e.createVNode("div",{class:"flex flex-col"},[e.createVNode("span",{class:"text-[10px] text-gray-400 uppercase tracking-wider font-semibold"},"Compartilhado por"),e.createVNode("span",{class:"text-xs font-medium text-gray-700 dark:text-gray-300"},e.toDisplayString((null==(c=r.collection.owner)?void 0:c.full_name)||"Desconhecido"),1)])])])];i(`<div class="p-4 flex flex-col h-full"${o}><div class="flex justify-between items-start mb-3"${o}><div class="w-10 h-10 rounded-lg bg-purple-50 dark:bg-purple-900/30 flex items-center justify-center text-purple-600 dark:text-purple-400"${o}>`),i(x(w,{name:"i-heroicons-folder-open",class:"w-6 h-6"},null,a,o)),i("</div>"),i(x(w,{name:"i-heroicons-eye",class:"text-gray-300 group-hover:text-purple-500 transition-colors"},null,a,o)),i(`</div><h3 class="text-lg font-bold text-gray-900 dark:text-white mb-1 group-hover:text-purple-500 transition-colors"${o}>${m(r.collection.name)}</h3><p class="text-gray-500 text-sm line-clamp-2 mb-4 flex-1"${o}>${m(r.collection.description||"Sem descrição")}</p><div class="flex items-center gap-2 pt-3 border-t border-gray-100 dark:border-gray-800"${o}>`),i(x(S,{src:null==(s=r.collection.owner)?void 0:s.avatar_url,size:"xs",class:"ring-2 ring-white dark:ring-gray-900"},null,a,o)),i(`<div class="flex flex-col"${o}><span class="text-[10px] text-gray-400 uppercase tracking-wider font-semibold"${o}>Compartilhado por</span><span class="text-xs font-medium text-gray-700 dark:text-gray-300"${o}>${m((null==(l=r.collection.owner)?void 0:l.full_name)||"Desconhecido")}</span></div></div></div>`)}),_:2},i))}),t("\x3c!--]--\x3e</div>")),t("</section></div></div>")}}}),y=v.setup;v.setup=(r,t)=>{const i=e.useSSRContext();return(i.modules||(i.modules=new Set)).add("pages/dashboard/index.vue"),y?y(r,t):void 0};export{v as default};
//# sourceMappingURL=index-Bt0ECUky.mjs.map
