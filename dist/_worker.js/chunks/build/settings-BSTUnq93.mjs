import{_ as e}from"./Card-CjK8ZZ2Z.mjs";import{v as a,u as r,k as l,f as t,e as o,_ as i}from"./server.mjs";import{_ as n,a as s}from"./Input-CWRe9pxK.mjs";import{_ as d}from"./Toggle-JvMqr6TW.mjs";import{u as c}from"./composables-PcvjsKU4.mjs";import{A as u,y as m}from"../routes/renderer.mjs";import"../_/nitro.mjs";import"node:async_hooks";import"../_/shared.esm-bundler.mjs";import"./keyboard-DfXvXu8t.mjs";const f=a.defineComponent({__name:"settings",__ssrInlineRender:!0,setup(f){const{user:p}=r(),v=l(),h=c(),g=a.ref(!1),x=a.reactive({full_name:"",avatar_url:""});a.watchEffect(()=>{p.value&&(x.full_name=p.value.name||"",x.avatar_url=p.value.avatar||"")});const toggleTheme=e=>{h.preference=e?"dark":"light"},y=a.ref(!1),V=a.ref(null),triggerFileInput=()=>{var e;null==(e=V.value)||e.click()},handleFileUpload=async e=>{const a=e.target.files[0];if(a&&p.value)if(a.type.startsWith("image/"))try{y.value=!0;const e=new FormData;e.append("file",a);const r=await $fetch("/api/user/avatar",{method:"POST",body:e});x.avatar_url=r.url,v.add({title:"Upload concluído",color:"green"})}catch(e){v.add({title:"Erro no Upload",description:e.message,color:"red"})}finally{y.value=!1}else v.add({title:"Erro",description:"Por favor envie apenas imagens.",color:"red"})},updateProfile=async()=>{try{g.value=!0,await $fetch("/api/user/profile",{method:"PATCH",body:{full_name:x.full_name,avatar_url:x.avatar_url}}),v.add({title:"Perfil atualizado",color:"green"})}catch(e){v.add({title:"Erro ao atualizar",description:e.message,color:"red"})}finally{g.value=!1}};return(r,l,c,f)=>{const v=e,_=o,w=t,b=i,N=n,k=s,C=d;l(`<div${u(a.mergeProps({class:"max-w-2xl mx-auto py-8"},f))}><div class="flex items-center gap-4 mb-8"><h1 class="text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 dark:from-white dark:to-gray-400 bg-clip-text text-transparent">Minha Conta</h1></div><div class="space-y-6">`),l(m(v,null,{header:a.withCtx((e,r,l,t)=>{if(!r)return[a.createVNode("div",{class:"flex items-center gap-3"},[a.createVNode("div",{class:"p-2 bg-primary-50 dark:bg-primary-900/20 rounded-lg text-primary-500"},[a.createVNode(_,{name:"i-heroicons-user",class:"w-5 h-5"})]),a.createVNode("h3",{class:"font-semibold text-lg"},"Perfil")])];r(`<div class="flex items-center gap-3"${t}><div class="p-2 bg-primary-50 dark:bg-primary-900/20 rounded-lg text-primary-500"${t}>`),r(m(_,{name:"i-heroicons-user",class:"w-5 h-5"},null,l,t)),r(`</div><h3 class="font-semibold text-lg"${t}>Perfil</h3></div>`)}),default:a.withCtx((e,r,l,t)=>{var o,i;if(!r)return[a.createVNode("form",{onSubmit:a.withModifiers(updateProfile,["prevent"]),class:"space-y-6"},[a.createVNode("div",{class:"flex flex-col items-center sm:flex-row gap-6 mb-6"},[a.createVNode("div",{class:"relative group cursor-pointer",onClick:triggerFileInput},[a.createVNode(w,{src:a.unref(x).avatar_url||(null==(i=a.unref(p))?void 0:i.avatar),alt:a.unref(x).full_name,size:"3xl",class:"ring-4 ring-gray-100 dark:ring-gray-800 transition-opacity group-hover:opacity-75"},null,8,["src","alt"]),a.createVNode("div",{class:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"},[a.createVNode(_,{name:"i-heroicons-camera",class:"w-8 h-8 text-gray-800 dark:text-white drop-shadow-md"})]),a.unref(y)?(a.openBlock(),a.createBlock("div",{key:0,class:"absolute inset-0 bg-white/50 dark:bg-black/50 rounded-full flex items-center justify-center"},[a.createVNode(_,{name:"i-heroicons-arrow-path",class:"w-8 h-8 animate-spin text-primary-500"})])):a.createCommentVNode("",!0)]),a.createVNode("input",{ref_key:"fileInput",ref:V,type:"file",class:"hidden",accept:"image/*",onChange:handleFileUpload},null,544),a.createVNode("div",{class:"flex-1 w-full space-y-4"},[a.createVNode("div",{class:"flex gap-2"},[a.createVNode(b,{color:"white",icon:"i-heroicons-arrow-up-tray",loading:a.unref(y),onClick:triggerFileInput},{default:a.withCtx(()=>[a.createTextVNode(" Upload de Foto ")]),_:1},8,["loading"]),a.unref(x).avatar_url?(a.openBlock(),a.createBlock(b,{key:0,color:"red",variant:"ghost",icon:"i-heroicons-trash",size:"xs",onClick:e=>a.unref(x).avatar_url=""},null,8,["onClick"])):a.createCommentVNode("",!0)]),a.createVNode(N,{label:"Ou URL do Avatar",help:"Link externo para imagem"},{default:a.withCtx(()=>[a.createVNode(k,{modelValue:a.unref(x).avatar_url,"onUpdate:modelValue":e=>a.unref(x).avatar_url=e,icon:"i-heroicons-photo",placeholder:"https://..."},null,8,["modelValue","onUpdate:modelValue"])]),_:1})])]),a.createVNode("div",{class:"grid gap-6"},[a.createVNode(N,{label:"Nome Completo",required:""},{default:a.withCtx(()=>[a.createVNode(k,{modelValue:a.unref(x).full_name,"onUpdate:modelValue":e=>a.unref(x).full_name=e,icon:"i-heroicons-identification"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a.createVNode(N,{label:"E-mail",help:"O e-mail não pode ser alterado."},{default:a.withCtx(()=>{var e;return[a.createVNode(k,{"model-value":null==(e=a.unref(p))?void 0:e.email,icon:"i-heroicons-envelope",disabled:"",color:"gray"},null,8,["model-value"])]}),_:1})]),a.createVNode("div",{class:"flex justify-end pt-4"},[a.createVNode(b,{type:"submit",loading:a.unref(g),size:"lg"},{default:a.withCtx(()=>[a.createTextVNode(" Salvar Alterações ")]),_:1},8,["loading"])])],32)];r(`<form class="space-y-6"${t}><div class="flex flex-col items-center sm:flex-row gap-6 mb-6"${t}><div class="relative group cursor-pointer"${t}>`),r(m(w,{src:a.unref(x).avatar_url||(null==(o=a.unref(p))?void 0:o.avatar),alt:a.unref(x).full_name,size:"3xl",class:"ring-4 ring-gray-100 dark:ring-gray-800 transition-opacity group-hover:opacity-75"},null,l,t)),r(`<div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"${t}>`),r(m(_,{name:"i-heroicons-camera",class:"w-8 h-8 text-gray-800 dark:text-white drop-shadow-md"},null,l,t)),r("</div>"),a.unref(y)?(r(`<div class="absolute inset-0 bg-white/50 dark:bg-black/50 rounded-full flex items-center justify-center"${t}>`),r(m(_,{name:"i-heroicons-arrow-path",class:"w-8 h-8 animate-spin text-primary-500"},null,l,t)),r("</div>")):r("\x3c!----\x3e"),r(`</div><input type="file" class="hidden" accept="image/*"${t}><div class="flex-1 w-full space-y-4"${t}><div class="flex gap-2"${t}>`),r(m(b,{color:"white",icon:"i-heroicons-arrow-up-tray",loading:a.unref(y),onClick:triggerFileInput},{default:a.withCtx((e,r,l,t)=>{if(!r)return[a.createTextVNode(" Upload de Foto ")];r(" Upload de Foto ")}),_:1},l,t)),a.unref(x).avatar_url?r(m(b,{color:"red",variant:"ghost",icon:"i-heroicons-trash",size:"xs",onClick:e=>a.unref(x).avatar_url=""},null,l,t)):r("\x3c!----\x3e"),r("</div>"),r(m(N,{label:"Ou URL do Avatar",help:"Link externo para imagem"},{default:a.withCtx((e,r,l,t)=>{if(!r)return[a.createVNode(k,{modelValue:a.unref(x).avatar_url,"onUpdate:modelValue":e=>a.unref(x).avatar_url=e,icon:"i-heroicons-photo",placeholder:"https://..."},null,8,["modelValue","onUpdate:modelValue"])];r(m(k,{modelValue:a.unref(x).avatar_url,"onUpdate:modelValue":e=>a.unref(x).avatar_url=e,icon:"i-heroicons-photo",placeholder:"https://..."},null,l,t))}),_:1},l,t)),r(`</div></div><div class="grid gap-6"${t}>`),r(m(N,{label:"Nome Completo",required:""},{default:a.withCtx((e,r,l,t)=>{if(!r)return[a.createVNode(k,{modelValue:a.unref(x).full_name,"onUpdate:modelValue":e=>a.unref(x).full_name=e,icon:"i-heroicons-identification"},null,8,["modelValue","onUpdate:modelValue"])];r(m(k,{modelValue:a.unref(x).full_name,"onUpdate:modelValue":e=>a.unref(x).full_name=e,icon:"i-heroicons-identification"},null,l,t))}),_:1},l,t)),r(m(N,{label:"E-mail",help:"O e-mail não pode ser alterado."},{default:a.withCtx((e,r,l,t)=>{var o,i;if(!r)return[a.createVNode(k,{"model-value":null==(i=a.unref(p))?void 0:i.email,icon:"i-heroicons-envelope",disabled:"",color:"gray"},null,8,["model-value"])];r(m(k,{"model-value":null==(o=a.unref(p))?void 0:o.email,icon:"i-heroicons-envelope",disabled:"",color:"gray"},null,l,t))}),_:1},l,t)),r(`</div><div class="flex justify-end pt-4"${t}>`),r(m(b,{type:"submit",loading:a.unref(g),size:"lg"},{default:a.withCtx((e,r,l,t)=>{if(!r)return[a.createTextVNode(" Salvar Alterações ")];r(" Salvar Alterações ")}),_:1},l,t)),r("</div></form>")}),_:1},c)),l(m(v,null,{header:a.withCtx((e,r,l,t)=>{if(!r)return[a.createVNode("div",{class:"flex items-center gap-3"},[a.createVNode("div",{class:"p-2 bg-gray-50 dark:bg-gray-800 rounded-lg text-gray-500"},[a.createVNode(_,{name:"i-heroicons-adjustments-horizontal",class:"w-5 h-5"})]),a.createVNode("h3",{class:"font-semibold text-lg"},"Preferências")])];r(`<div class="flex items-center gap-3"${t}><div class="p-2 bg-gray-50 dark:bg-gray-800 rounded-lg text-gray-500"${t}>`),r(m(_,{name:"i-heroicons-adjustments-horizontal",class:"w-5 h-5"},null,l,t)),r(`</div><h3 class="font-semibold text-lg"${t}>Preferências</h3></div>`)}),default:a.withCtx((e,r,l,t)=>{if(!r)return[a.createVNode("div",{class:"flex items-center justify-between py-2"},[a.createVNode("div",{class:"flex flex-col"},[a.createVNode("span",{class:"font-medium"},"Tema Escuro"),a.createVNode("span",{class:"text-sm text-gray-500"},"Alternar entre modo claro e escuro.")]),a.createVNode(C,{size:"lg","model-value":"dark"===a.unref(h).value,"onUpdate:modelValue":toggleTheme},null,8,["model-value"])])];r(`<div class="flex items-center justify-between py-2"${t}><div class="flex flex-col"${t}><span class="font-medium"${t}>Tema Escuro</span><span class="text-sm text-gray-500"${t}>Alternar entre modo claro e escuro.</span></div>`),r(m(C,{size:"lg","model-value":"dark"===a.unref(h).value,"onUpdate:modelValue":toggleTheme},null,l,t)),r("</div>")}),_:1},c)),l("</div></div>")}}}),p=f.setup;f.setup=(e,r)=>{const l=a.useSSRContext();return(l.modules||(l.modules=new Set)).add("pages/settings.vue"),p?p(e,r):void 0};export{f as default};
//# sourceMappingURL=settings-BSTUnq93.mjs.map
