import{f as z,g as F,q as D,s as p,y as S,B as T,C as $,c as f,a as s,b as n,w as a,m as t,z as q,D as A,F as I,r as j,v as R,j as E,o as c,d as _,A as M,n as O}from"./fMH9WF-P.js";import{_ as P,a as G}from"./B7Xsw2Wk.js";import{_ as L,a as H,b as J}from"./Dr655yUR.js";import{_ as K}from"./Ccg_Gj5U.js";const Q={class:"max-w-3xl mx-auto p-4"},W={class:"flex items-center gap-4 mb-6"},X={class:"space-y-4"},Y={class:"relative mb-6"},Z={key:0,class:"text-center py-8 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg"},ee={class:"space-y-4"},oe={class:"flex justify-end gap-3"},ie=z({__name:"new",setup(se){const{loggedIn:C}=F(),b=D(),m=p(!1),o=S({name:"",description:"",visibility:"private",fields:[]}),x=()=>{o.fields.push({name:"",type:"text",options:[],visible:!0,required:!1,is_dynamic:!1,selected:!1,folder_order:o.fields.length})},h=l=>{o.fields.splice(l,1)},V=async()=>{if(C.value&&!(o.fields.length===0&&!confirm("Criar coleção sem nenhum campo personalizado?")))try{m.value=!0,await $fetch("/api/collections",{method:"POST",body:{name:o.name,description:o.description,visibility:o.visibility,fields:o.fields}}),b.add({title:"Sucesso",description:"Coleção criada com sucesso",color:"green"}),O("/dashboard")}catch(l){b.add({title:"Erro",description:l.message,color:"red"})}finally{m.value=!1}},v=p(!1),u=p(null);return T(()=>{const l=new IntersectionObserver(([e])=>{v.value=!e.isIntersecting&&e.boundingClientRect.top<0},{threshold:1});u.value&&l.observe(u.value)}),$(()=>{}),(l,e)=>{const r=E,k=G,g=P,U=H,w=K,B=L,N=J;return c(),f("div",Q,[s("div",W,[n(r,{icon:"i-heroicons-arrow-left",variant:"ghost",to:"/dashboard"}),e[3]||(e[3]=s("h1",{class:"text-2xl font-bold"},"Criar Nova Coleção",-1))]),s("form",{onSubmit:R(V,["prevent"])},[n(w,{class:"mb-6"},{header:a(()=>[...e[4]||(e[4]=[s("h2",{class:"font-semibold"},"Detalhes Básicos",-1)])]),default:a(()=>[s("div",X,[n(g,{label:"Nome da Coleção",required:""},{default:a(()=>[n(k,{modelValue:t(o).name,"onUpdate:modelValue":e[0]||(e[0]=i=>t(o).name=i),placeholder:"ex. Discos de Vinil",required:""},null,8,["modelValue"])]),_:1}),n(g,{label:"Descrição"},{default:a(()=>[n(U,{modelValue:t(o).description,"onUpdate:modelValue":e[1]||(e[1]=i=>t(o).description=i),placeholder:"Uma coleção dos meus discos raros..."},null,8,["modelValue"])]),_:1})])]),_:1}),n(B,{modelValue:t(o).visibility,"onUpdate:modelValue":e[2]||(e[2]=i=>t(o).visibility=i),class:"mb-6"},null,8,["modelValue"]),s("div",Y,[s("div",{ref_key:"sentinel",ref:u,class:"absolute -top-1 left-0 right-0 h-1 pointer-events-none"},null,512),s("div",{class:A(["flex justify-between items-center mb-4 sticky top-0 z-10 py-4 transition-all duration-300 dark:bg-transparent",[t(v)?"backdrop-blur-md border-b border-gray-200 dark:border-gray-800":"border-transparent"]])},[e[6]||(e[6]=s("h2",{class:"text-lg font-semibold"},"Campos Personalizados",-1)),n(r,{size:"sm",icon:"i-heroicons-plus",onClick:x},{default:a(()=>[...e[5]||(e[5]=[_("Adicionar Campo",-1)])]),_:1})],2),t(o).fields.length===0?(c(),f("div",Z,[...e[7]||(e[7]=[s("p",{class:"text-gray-500"},"Nenhum campo definido. Adicione campos para estruturar sua coleção.",-1)])])):q("",!0),s("div",ee,[(c(!0),f(I,null,j(t(o).fields,(i,d)=>(c(),M(N,{key:d,modelValue:t(o).fields[d],"onUpdate:modelValue":y=>t(o).fields[d]=y,onRemove:y=>h(d)},null,8,["modelValue","onUpdate:modelValue","onRemove"]))),128))])]),s("div",oe,[n(r,{to:"/dashboard",color:"gray",variant:"ghost"},{default:a(()=>[...e[8]||(e[8]=[_("Cancelar",-1)])]),_:1}),n(r,{type:"submit",loading:t(m)},{default:a(()=>[...e[9]||(e[9]=[_("Criar Coleção",-1)])]),_:1},8,["loading"])])],32)])}}});export{ie as default};
