import{f as T,g as j,q as A,s as v,y as B,i as F,c as k,a,b as t,w as r,o as h,v as I,z as U,p as N,m as o,l as $,A as M,j as S,d as C}from"./fMH9WF-P.js";import{_ as O,a as q}from"./B7Xsw2Wk.js";import{_ as D}from"./Ccg_Gj5U.js";import{_ as L}from"./ChT32_lM.js";import{u as G}from"./CLeC6Fnv.js";import"./BpJ0bP9P.js";const H={class:"max-w-2xl mx-auto py-8"},R={class:"space-y-6"},W={class:"flex items-center gap-3"},J={class:"p-2 bg-primary-50 dark:bg-primary-900/20 rounded-lg text-primary-500"},K={class:"flex flex-col items-center sm:flex-row gap-6 mb-6"},Q={class:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"},X={key:0,class:"absolute inset-0 bg-white/50 dark:bg-black/50 rounded-full flex items-center justify-center"},Y={class:"flex-1 w-full space-y-4"},Z={class:"flex gap-2"},ee={class:"grid gap-6"},ae={class:"flex justify-end pt-4"},te={class:"flex items-center gap-3"},oe={class:"p-2 bg-gray-50 dark:bg-gray-800 rounded-lg text-gray-500"},le={class:"flex items-center justify-between py-2"},me=T({__name:"settings",setup(se){const{user:n}=j(),d=A(),y=G(),m=v(!1),l=B({full_name:"",avatar_url:""});F(()=>{n.value&&(l.full_name=n.value.name||"",l.avatar_url=n.value.avatar||"")});const V=i=>{y.preference=i?"dark":"light"},c=v(!1),x=v(null),b=()=>{x.value?.click()},z=async i=>{const e=i.target.files[0];if(!(!e||!n.value)){if(!e.type.startsWith("image/")){d.add({title:"Erro",description:"Por favor envie apenas imagens.",color:"red"});return}try{c.value=!0;const s=new FormData;s.append("file",e);const p=await $fetch("/api/user/avatar",{method:"POST",body:s});l.avatar_url=p.url,d.add({title:"Upload concluído",color:"green"})}catch(s){d.add({title:"Erro no Upload",description:s.message,color:"red"})}finally{c.value=!1}}},E=async()=>{try{m.value=!0,await $fetch("/api/user/profile",{method:"PATCH",body:{full_name:l.full_name,avatar_url:l.avatar_url}}),d.add({title:"Perfil atualizado",color:"green"})}catch(i){d.add({title:"Erro ao atualizar",description:i.message,color:"red"})}finally{m.value=!1}};return(i,e)=>{const s=$,p=N,_=S,f=q,g=O,w=D,P=L;return h(),k("div",H,[e[8]||(e[8]=a("div",{class:"flex items-center gap-4 mb-8"},[a("h1",{class:"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 dark:from-white dark:to-gray-400 bg-clip-text text-transparent"},"Minha Conta")],-1)),a("div",R,[t(w,null,{header:r(()=>[a("div",W,[a("div",J,[t(s,{name:"i-heroicons-user",class:"w-5 h-5"})]),e[3]||(e[3]=a("h3",{class:"font-semibold text-lg"},"Perfil",-1))])]),default:r(()=>[a("form",{onSubmit:I(E,["prevent"]),class:"space-y-6"},[a("div",K,[a("div",{class:"relative group cursor-pointer",onClick:b},[t(p,{src:o(l).avatar_url||o(n)?.avatar,alt:o(l).full_name,size:"3xl",class:"ring-4 ring-gray-100 dark:ring-gray-800 transition-opacity group-hover:opacity-75"},null,8,["src","alt"]),a("div",Q,[t(s,{name:"i-heroicons-camera",class:"w-8 h-8 text-gray-800 dark:text-white drop-shadow-md"})]),o(c)?(h(),k("div",X,[t(s,{name:"i-heroicons-arrow-path",class:"w-8 h-8 animate-spin text-primary-500"})])):U("",!0)]),a("input",{ref_key:"fileInput",ref:x,type:"file",class:"hidden",accept:"image/*",onChange:z},null,544),a("div",Y,[a("div",Z,[t(_,{color:"white",icon:"i-heroicons-arrow-up-tray",loading:o(c),onClick:b},{default:r(()=>[...e[4]||(e[4]=[C(" Upload de Foto ",-1)])]),_:1},8,["loading"]),o(l).avatar_url?(h(),M(_,{key:0,color:"red",variant:"ghost",icon:"i-heroicons-trash",size:"xs",onClick:e[0]||(e[0]=u=>o(l).avatar_url="")})):U("",!0)]),t(g,{label:"Ou URL do Avatar",help:"Link externo para imagem"},{default:r(()=>[t(f,{modelValue:o(l).avatar_url,"onUpdate:modelValue":e[1]||(e[1]=u=>o(l).avatar_url=u),icon:"i-heroicons-photo",placeholder:"https://..."},null,8,["modelValue"])]),_:1})])]),a("div",ee,[t(g,{label:"Nome Completo",required:""},{default:r(()=>[t(f,{modelValue:o(l).full_name,"onUpdate:modelValue":e[2]||(e[2]=u=>o(l).full_name=u),icon:"i-heroicons-identification"},null,8,["modelValue"])]),_:1}),t(g,{label:"E-mail",help:"O e-mail não pode ser alterado."},{default:r(()=>[t(f,{"model-value":o(n)?.email,icon:"i-heroicons-envelope",disabled:"",color:"gray"},null,8,["model-value"])]),_:1})]),a("div",ae,[t(_,{type:"submit",loading:o(m),size:"lg"},{default:r(()=>[...e[5]||(e[5]=[C(" Salvar Alterações ",-1)])]),_:1},8,["loading"])])],32)]),_:1}),t(w,null,{header:r(()=>[a("div",te,[a("div",oe,[t(s,{name:"i-heroicons-adjustments-horizontal",class:"w-5 h-5"})]),e[6]||(e[6]=a("h3",{class:"font-semibold text-lg"},"Preferências",-1))])]),default:r(()=>[a("div",le,[e[7]||(e[7]=a("div",{class:"flex flex-col"},[a("span",{class:"font-medium"},"Tema Escuro"),a("span",{class:"text-sm text-gray-500"},"Alternar entre modo claro e escuro.")],-1)),t(P,{size:"lg","model-value":o(y).value==="dark","onUpdate:modelValue":V},null,8,["model-value"])])]),_:1})])])}}});export{me as default};
